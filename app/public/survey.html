<!DOCTYPE html>
<html>

<head>
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="/css/materialize.min.css" media="screen,projection" />
  <link type="text/css" rel="stylesheet" href="/css/main.css" />
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Materialize Theme</title>
</head>

<body>
  <div class="navbar-fixed">
    <nav class="red lighten-2">
      <div class="container">
        <div class="nav-wrapper">
          <a href="#home" class="brand-logo">Friend Finder</a>
          <a href="#" data-activates="mobile-nav" class="button-collapse">
            <i class="material-icons">menu</i>
          </a>
          <ul class="right hide-on-med-and-down">
            <li>
              <a href="/home.html">Home</a>
            </li>
            <li>
              <a href="/survey.html">Survey</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
  <ul class="right side-nav " id="mobile-nav">
    <li>
      <a href="/home.html">Home</a>
    </li>
    <li>
      <a href="/survey.html">Survey</a>
    </li>
  </ul>
  <section class='survey'>

    <div class='container'>

      <h4>About You!</h4>
      <div class="row">
        <form>
          <div class="col s12">
            <div class="row">
              <div class="input-field col s6">
                <i class="material-icons prefix">account_circle</i>
                <input id="icon_prefix" type="text" class="validate user-name">
                <label for="icon_prefix">First Name</label>
              </div>
              <div class="input-field col s6">
                <i class="material-icons prefix">insert_photo</i>
                <input id="icon_prefix" type="text" class="photo">
                <label for="icon_photo">Link to your photo </label>
              </div>
            </div>
            <div>
              <p>Your mind is always buzzing with unexplored ideas and plans.</p>
              <div class='choices'>
                <input id="q1-choice_1" name="group1" type="radio" value="1" />
                <label for="q1-choice_1">1 Strongly Disagree</label>
                <input id="q1-choice_2" name="group1" type="radio" value="2" />
                <label for="q1-choice_2">2</label>
                <input id="q1-choice_3" name="group1" type="radio" value="3" />
                <label for="q1-choice_3">3</label>
                <input id="q1-choice_4" name="group1" type="radio" value="4" />
                <label for="q1-choice_4">4</label>
                <input id="q1-choice_5" name="group1" type="radio" value="5" />
                <label for="q1-choice_5">5 Strongly Agree</label>
              </div>
            </div>
            <div>
              <p>Generally speaking, you rely more on your experience than your imagination.</p>
              <div class='choices'>
                <input id="q2-choice_1" name="group2" type="radio" value="1" />
                <label for="q2-choice_1" value="1">1 Strongly Disagree</label>
                <input id="q2-choice_2" name="group2" type="radio" value="2" />
                <label for="q2-choice_2">2</label>
                <input id="q2-choice_3" name="group2" type="radio" value="3" />
                <label for="q2-choice_3">3</label>
                <input id="q2-choice_4" name="group2" type="radio" value="4" />
                <label for="q2-choice_4">4</label>
                <input id="q2-choice_5" name="group2" type="radio" value="5" />
                <label for="q2-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>You find it easy to stay relaxed and focused even when there is some pressure..</p>
              <div class='choices'>
                <input id="q3-choice_1" name="group3" type="radio" value="1" />
                <label for="q3-choice_1">1 Strongly Disagree</label>
                <input id="q3-choice_2" name="group3" type="radio" value="2" />
                <label for="q3-choice_2">2</label>
                <input id="q3-choice_3" name="group3" type="radio" value="3" />
                <label for="q3-choice_3">3</label>
                <input id="q3-choice_4" name="group3" type="radio" value="4" />
                <label for="q3-choice_4">4</label>
                <input id="q3-choice_5" name="group3" type="radio" value="5" />
                <label for="q3-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>You rarely do something just out of sheer curiosity.</p>
              <div class='choices'>
                <input id="q4-choice_1" name="group4" type="radio" value="1" />
                <label for="q4-choice_1">1 Strongly Disagree</label>
                <input id="q4-choice_2" name="group4" type="radio" value="2" />
                <label for="q4-choice_2">2</label>
                <input id="q4-choice_3" name="group4" type="radio" value="3" />
                <label for="q4-choice_3">3</label>
                <input id="q4-choice_4" name="group4" type="radio" value="4" />
                <label for="q4-choice_4">4</label>
                <input id="q4-choice_5" name="group4" type="radio" value="5" />
                <label for="q4-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>People can rarely upset you.</p>
              <div class='choices'>
                <input id="q5-choice_1" name="group5" type="radio" value="1" />
                <label for="q5-choice_1">1 Strongly Disagree</label>
                <input id="q5-choice_2" name="group5" type="radio" value="2" />
                <label for="q5-choice_2">2</label>
                <input id="q5-choice_3" name="group5" type="radio" value="3" />
                <label for="q5-choice_3">3</label>
                <input id="q5-choice_4" name="group5" type="radio" value="4" />
                <label for="q5-choice_4">4</label>
                <input id="q5-choice_5" name="group5" type="radio" value="5" />
                <label for="q5-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>It is often difficult for you to relate to other people’s feelings.
              </p>
              <div class='choices'>
                <input id="q6-choice_1" name="group6" type="radio" value="1" />
                <label for="q6-choice_1">1 Strongly Disagree</label>
                <input id="q6-choice_2" name="group6" type="radio" value="2" />
                <label for="q6-choice_2">2</label>
                <input id="q6-choice_3" name="group6" type="radio" value="3" />
                <label for="q6-choice_3">3</label>
                <input id="q6-choice_4" name="group6" type="radio" value="4" />
                <label for="q6-choice_4">4</label>
                <input id="q6-choice_5" name="group6" type="radio" value="5" />
                <label for="q6-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>In a discussion, truth should be more important than people’s sensitivities.
              </p>
              <div class='choices'>
                <input id="q7-choice_1" name="group7" type="radio" value="1" />
                <label for="q7-choice_1">1 Strongly Disagree</label>
                <input id="q7-choice_2" name="group7" type="radio" value="2" />
                <label for="q7-choice_2">2</label>
                <input id="q7-choice_3" name="group7" type="radio" value="3" />
                <label for="q7-choice_3">3</label>
                <input id="q7-choice_4" name="group7" type="radio" value="4" />
                <label for="q7-choice_4">4</label>
                <input id="q7-choice_5" name="group7" type="radio" value="5" />
                <label for="q7-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>You rarely get carried away by fantasies and ideas.
              </p>
              <div class='choices'>
                <input id="q8-choice_1" name="group8" type="radio" value="1" />
                <label for="q8-choice_1">1 Strongly Disagree</label>
                <input id="q8-choice_2" name="group8" type="radio" value="2" />
                <label for="q8-choice_2">2</label>
                <input id="q8-choice_3" name="group8" type="radio" value="3" />
                <label for="q8-choice_3">3</label>
                <input id="q8-choice_4" name="group8" type="radio" value="4" />
                <label for="q8-choice_4">4</label>
                <input id="q8-choice_5" name="group8" type="radio" value="5" />
                <label for="q8-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.
              </p>
              <div class='choices'>
                <input id="q9-choice_1" name="group9" type="radio" value="1" />
                <label for="q9-choice_1">1 Strongly Disagree</label>
                <input id="q9-choice_2" name="group9" type="radio" value="2" />
                <label for="q9-choice_2">2</label>
                <input id="q9-choice_3" name="group9" type="radio" value="3" />
                <label for="q9-choice_3">3</label>
                <input id="q9-choice_4" name="group9" type="radio" value="4" />
                <label for="q9-choice_4">4</label>
                <input id="q9-choice_5" name="group9" type="radio" value="5" />
                <label for="q9-choice_5">5 Strongly Agree</label>
              </div>
            </div>

            <div>
              <p>You feel more energetic after spending time with a group of people.
              </p>
              <div class='choices'>
                <input id="q10-choice_1" name="group10" type="radio" value="1" />
                <label for="q10-choice_1">1 Strongly Disagree</label>
                <input id="q10-choice_2" name="group10" type="radio" value="2" />
                <label for="q10-choice_2">2</label>
                <input id="q10-choice_3" name="group10" type="radio" value="3" />
                <label for="q10-choice_3">3</label>
                <input id="q10-choice_4" name="group10" type="radio" value="4" />
                <label for="q10-choice_4">4</label>
                <input id="q10-choice_5" name="group10" type="radio" value="5" />
                <label for="q10-choice_5">5 Strongly Agree</label>
              </div>
            </div>
          </div>
          <div class="col s12 submit-button">
            <button class="btn waves-effect waves-light submit" type="submit" name="action">Submit
            </button>
          </div>
      </div>
    </div>
    </form>



  </section>
  <!--Import jQuery before materialize.js-->
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="js/materialize.min.js"></script>
  <script>
    $(document).ready(function () {
      $('.button-collapse').sideNav();

    });
  </script>
</body>

</html>


<script type="text/javascript">
  $(".submit").on("click", function (event) {
    event.preventDefault();

    // Here we grab the form elements
    let currentUser = {
      name: $(".user-name").val().trim(),
      photo: $(".photo").val().trim(),
      scores: [
        q1 = $('input[name=group1]:checked').val(),
        q2 = $('input[name=group2]:checked').val(),
        q3 = $('input[name=group3]:checked').val(),
        q4 = $('input[name=group4]:checked').val(),
        q5 = $('input[name=group5]:checked').val(),
        q6 = $('input[name=group6]:checked').val(),
        q7 = $('input[name=group7]:checked').val(),
        q8 = $('input[name=group8]:checked').val(),
        q9 = $('input[name=group9]:checked').val(),
        q10 = $('input[name=group10]:checked').val()
      ]
    };

    console.log(currentUser);

    function getFriends() {
      $.ajax({
          url: "/api/friends",
          method: "GET"
        })
        .then(function (friendsData) {
          mostCompatibleFriend(friendsData)

        });

      function mostCompatibleFriend(friendsData) {
        let totalDifference = []

        for (var i = 0; i < friendsData.length; i++) {


          let friendScores = friendsData[i].scores
          let currentUserScore = currentUser.scores

          let scoreArray = differenceInScores(friendScores, currentUserScore)
          console.log(scoreArray)
          const reducer = (accumulator, currentValue) => accumulator + currentValue;
          let difference = scoreArray.reduce(reducer);
          totalDifference.push(difference)

        }

        let leastDifference = Math.min(...totalDifference)
        let index = totalDifference.indexOf(leastDifference)
        let mostCompatible = friendsData[index]
        console.log(mostCompatible)


      }

      /*function differenceInArray(friendScores, currentUserScore) {
        return currentUserScore.map(function (el, i) {
          return Math.abs(el - friendScores[i]);
        });
      }*/

      function differenceInScores(friendScores, currentUserScore) {
        let differenceArray = []
        for (let i = 0; i < friendScores.length; i++) {
          differenceArray.push(Math.abs(friendScores[i] - currentUserScore[i]))
        }
        return differenceArray
      }

    }

    getFriends()



    /*$.post("/api/friends", newReservation,
      function (data) {

        // If a table is available... tell user they are booked.
        if (data) {
          alert("Yay! You are officially booked!");
        }

        // If a table is available... tell user they on the waiting list.
        else {
          alert("Sorry you are on the wait list");
        }

        // Clear the form when submitting
        $("#reserve-name").val("");
        $("#reserve-phone").val("");
        $("#reserve-email").val("");
        $("#reserve-unique-id").val("");

      }); */

  });
</script>